POST /_plugins/_ml/connectors/_create

{
  "name": "bge_m3_embedding_connector",
  "description": "Local Ollama connector for BGE-M3 embeddings",
  "version": "1",
  "protocol": "http",
  "parameters": {
    "endpoint": "http://192.168.10.200:11434",
    "model": "bge-m3"
  },
  "credential": {
    "openAI_key": "dummy"
  },
  "actions": [
    {
      "action_type": "predict",
      "method": "POST",
      "url": "${parameters.endpoint}/v1/embeddings",
      "headers": {
        "Content-Type": "application/json"
      },
      "request_body": "{ \"input\": ${parameters.input}, \"model\": \"${parameters.model}\" }",
      "pre_process_function": "connector.pre_process.openai.embedding",
      "post_process_function": "connector.post_process.openai.embedding"
    }
  ]
}


POST /_plugins/_ml/models/_create
{
  "name": "bge_m3_embedding_model",
  "description": "Embedding model via BGE-M3 on Ollama",
  "connector_id": "KniwOZoBER805w8yVYN4",
  "function_name": "remote"
}

POST /_plugins/_ml/models/bge_m3_embedding_model/predict
{
  "parameters": {
    "input": [
      "Test sentence for embedding."
    ]
  }
}


PUT _ingest/pipeline/property-vectorizer-pipeline
{
  "description": "Embed property listings using BGE-M3, continue on failure",
  "processors": [
    {
      "text_embedding": {
        "model_id": "LHi-OZoBER805w8yUoOH",
        "field_map": {
          "description": "listing_vector"
        },
        "on_failure": [
          {
            "set": {
              "field": "listing_vector",
              "value": []
            }
          },
          {
            "set": {
              "field": "embedding_status",
              "value": "failed"
            }
          }
        ]
      }
    }
  ]
}

POST /_ingest/pipeline/property-vectorizer-pipeline/_simulate
{
  "docs": [
    {
      "_source": {
        "description": "Beautiful apartment in Bucharest.",
        "price": 150000,
        "currency": "EUR",
        "location_1": "Bucharest",
        "name": "Test Listing"
      }
    }
  ]
}